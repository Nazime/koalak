<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=../install/ rel=prev><link href=../features/metadata/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.14"><title>Quickstart - Koalak</title><link rel=stylesheet href=../../assets/stylesheets/main.342714a4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/css/hint.min.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#quickstart class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=Koalak class="md-header__button md-logo" aria-label=Koalak data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Koalak </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Quickstart </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=Koalak class="md-nav__button md-logo" aria-label=Koalak data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Koalak </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Koalak </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Plugin manager </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Plugin manager </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../install/ class=md-nav__link> <span class=md-ellipsis> Install </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Quickstart </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Quickstart </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#basics class=md-nav__link> <span class=md-ellipsis> Basics </span> </a> </li> <li class=md-nav__item> <a href=#development-flow-in-plugin-manager class=md-nav__link> <span class=md-ellipsis> Development Flow in Plugin Manager </span> </a> </li> <li class=md-nav__item> <a href=#example class=md-nav__link> <span class=md-ellipsis> Example </span> </a> <nav class=md-nav aria-label=Example> <ul class=md-nav__list> <li class=md-nav__item> <a href=#define-the-base-plugin-class class=md-nav__link> <span class=md-ellipsis> Define the Base Plugin Class </span> </a> </li> <li class=md-nav__item> <a href=#create-the-pluginmanager-instance class=md-nav__link> <span class=md-ellipsis> Create the PluginManager Instance </span> </a> </li> <li class=md-nav__item> <a href=#initialize-the-pluginmanager class=md-nav__link> <span class=md-ellipsis> Initialize the PluginManager </span> </a> </li> <li class=md-nav__item> <a href=#create-our-plugins class=md-nav__link> <span class=md-ellipsis> Create our plugins </span> </a> </li> <li class=md-nav__item> <a href=#implement-core-business-logic class=md-nav__link> <span class=md-ellipsis> Implement Core Business Logic </span> </a> </li> <li class=md-nav__item> <a href=#all-the-code class=md-nav__link> <span class=md-ellipsis> All the code </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex=0> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Features </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../features/metadata/ class=md-nav__link> <span class=md-ellipsis> Metadata </span> </a> </li> <li class=md-nav__item> <a href=../features/plugins_constraints/ class=md-nav__link> <span class=md-ellipsis> Plugins Constraints </span> </a> </li> <li class=md-nav__item> <a href=../features/config_attributes/ class=md-nav__link> <span class=md-ellipsis> Config attributes </span> </a> </li> <li class=md-nav__item> <a href=../features/abstract_plugin/ class=md-nav__link> <span class=md-ellipsis> Abstract Plugin </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../next_steps/ class=md-nav__link> <span class=md-ellipsis> Next Steps </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#basics class=md-nav__link> <span class=md-ellipsis> Basics </span> </a> </li> <li class=md-nav__item> <a href=#development-flow-in-plugin-manager class=md-nav__link> <span class=md-ellipsis> Development Flow in Plugin Manager </span> </a> </li> <li class=md-nav__item> <a href=#example class=md-nav__link> <span class=md-ellipsis> Example </span> </a> <nav class=md-nav aria-label=Example> <ul class=md-nav__list> <li class=md-nav__item> <a href=#define-the-base-plugin-class class=md-nav__link> <span class=md-ellipsis> Define the Base Plugin Class </span> </a> </li> <li class=md-nav__item> <a href=#create-the-pluginmanager-instance class=md-nav__link> <span class=md-ellipsis> Create the PluginManager Instance </span> </a> </li> <li class=md-nav__item> <a href=#initialize-the-pluginmanager class=md-nav__link> <span class=md-ellipsis> Initialize the PluginManager </span> </a> </li> <li class=md-nav__item> <a href=#create-our-plugins class=md-nav__link> <span class=md-ellipsis> Create our plugins </span> </a> </li> <li class=md-nav__item> <a href=#implement-core-business-logic class=md-nav__link> <span class=md-ellipsis> Implement Core Business Logic </span> </a> </li> <li class=md-nav__item> <a href=#all-the-code class=md-nav__link> <span class=md-ellipsis> All the code </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=quickstart>Quickstart</h1> <h2 id=basics>Basics</h2> <p>The <code class=highlight>plugin_manager</code> module enables you to create a plugin architecture where each plugin is represented by a class that inherits from a base plugin class you define. The <code class=highlight>PluginManager</code> is linked to this <code class=highlight>base_plugin</code> and automatically registers plugins when they inherit from it. It functions similarly to a dictionary (<code class=highlight>dict[str, Plugin]</code>), with advanced features.</p> <p>Key concepts:</p> <ul> <li><strong>Plugin Name</strong>: Each plugin requires a <code class=highlight>name</code> attribute, which acts as a unique identifier.</li> <li><strong>Plugin Metadata</strong>: Plugins can have additional metadata attributes, such as description, authors, and version, to provide more context.</li> </ul> <h2 id=development-flow-in-plugin-manager>Development Flow in Plugin Manager</h2> <p>To effectively use the <code class=highlight>PluginManager</code>, follow this workflow:</p> <ol> <li><strong>Define the Base Plugin</strong>: Create a base class for your plugins, which provides utility functions and enforces constraints by requiring the implementation of specific methods or declaration of attributes in the subclasses. The base class must inherit from <code class=highlight>koalak.plugin_manager.Plugin</code>.</li> <li><strong>Create a PluginManager Instance</strong>: Instantiate the <code class=highlight>PluginManager</code>, passing your base class as the <code class=highlight>base_plugin</code> parameter. You can also add additional configuration options to customize the behavior of the <code class=highlight>PluginManager</code>.</li> <li><strong>Initialize the PluginManager</strong>: Call <code class=highlight>PluginManager.init()</code> to initialize the home directory, generate a configuration file, and load plugins from the home directory.</li> <li><strong>Load Plugins</strong>: Ensure the plugin files are imported to automatically register the plugins with the <code class=highlight>PluginManager</code>.</li> <li><strong>Execute Business Logic</strong>: Once plugins are registered, you can interact with them and perform the desired business logic.</li> </ol> <h2 id=example>Example</h2> <p>In this example, we address the need for a flexible system to perform various operations on a list of integers. For instance, we might want to double each element, add the number <code class=highlight><span class=mf>5</span></code> to each element, or filter the list to keep only even numbers. Additionally, these operations can be categorized: some plugins modify the size of the data (e.g., filtering out elements), while others maintain the same size (e.g., transforming values).</p> <p>To handle these requirements efficiently and flexibly, we can use the <code class=highlight>PluginManager</code> module. It allows us to define a standardized plugin architecture where each operation is implemented as a plugin. This approach makes it easy to extend the system by adding new operations without altering the existing code. Each plugin inherits from a base class, <code class=highlight>ListOperation</code>, ensuring consistency across all plugins.</p> <h3 id=define-the-base-plugin-class>Define the Base Plugin Class</h3> <p>To begin, we will create a base class <code class=highlight>ListOperator</code> that serves as the parent class for all future plugins. This base class must inherit from <code class=highlight>plugin_manager.Plugin</code>. We want to enforce the following constraints for all plugins:</p> <ul> <li> <p><strong>Implementation of the <code class=highlight>compute</code> Method</strong> All plugins must implement the <code class=highlight>compute</code> method, which is the core method for processing the plugin's logic. This method will act as an abstract method. Instead of raising an error during object instantiation, the error will occur at the plugin class definition if the <code class=highlight>compute</code> method is not implemented. To achieve this, we decorate the method in the base class with <code class=highlight>plugin_manager.abstract</code>.</p> </li> <li> <p><strong>Required <code class=highlight>max_length</code> Attribute</strong> Every plugin must define a required attribute <code class=highlight>max_length</code> of type <code class=highlight>int</code>, specifying the maximum length the plugin can handle. To enforce this constraint, we use the <code class=highlight>plugin_manager.field</code> attribute and specify the type <code class=highlight>int</code> through annotation.</p> </li> <li> <p><strong>Metadata: <code class=highlight>category</code></strong> All plugins must include the metadata key <code class=highlight>category</code>, which can either be <code class=highlight>filter</code> or <code class=highlight>transform</code>. To ensure this constraint is met, we define a <code class=highlight>Metadata</code> class within the base class and use <code class=highlight>plugin_manager.field</code> to enforce the allowed values with the <code class=highlight><span class=nx>choices</span></code> parameter. It's important to note that metadata attributes are not customizable, only predefined keys, such as <code class=highlight>category</code>, can be used, and we can only constrain their values.</p> </li> </ul> <div class=highlight><pre><span></span><code><a id=codeblock-0-1 name=codeblock-0-1 href=#codeblock-0-1></a><span class=c1># Import everything we will need</span>
<a id=codeblock-0-2 name=codeblock-0-2 href=#codeblock-0-2></a><span class=kn>from</span><span class=w> </span><span class=nn>koalak.plugin_manager</span><span class=w> </span><span class=kn>import</span> <span class=n>PluginManager</span><span class=p>,</span> <span class=n>Metadata</span><span class=p>,</span> <span class=n>field</span><span class=p>,</span> <span class=n>abstract</span><span class=p>,</span> <span class=n>config_field</span>
<a id=codeblock-0-3 name=codeblock-0-3 href=#codeblock-0-3></a>
<a id=codeblock-0-4 name=codeblock-0-4 href=#codeblock-0-4></a>
<a id=codeblock-0-5 name=codeblock-0-5 href=#codeblock-0-5></a><span class=k>class</span><span class=w> </span><span class=nc>ListOperation</span><span class=p>:</span>
<a id=codeblock-0-6 name=codeblock-0-6 href=#codeblock-0-6></a>    <span class=k>class</span><span class=w> </span><span class=nc>Metadata</span><span class=p>:</span>
<a id=codeblock-0-7 name=codeblock-0-7 href=#codeblock-0-7></a>        <span class=c1># Force all plugins to have the &#39;category&#39; metadata which is equal to &#39;filter&#39; or &#39;transform&#39;</span>
<a id=codeblock-0-8 name=codeblock-0-8 href=#codeblock-0-8></a>        <span class=n>category</span> <span class=o>=</span> <span class=n>field</span><span class=p>(</span><span class=n>choices</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;filter&quot;</span><span class=p>,</span> <span class=s2>&quot;transform&quot;</span><span class=p>])</span>
<a id=codeblock-0-9 name=codeblock-0-9 href=#codeblock-0-9></a>
<a id=codeblock-0-10 name=codeblock-0-10 href=#codeblock-0-10></a>    <span class=c1># Enforce our plugins to define the attrirbute max_length</span>
<a id=codeblock-0-11 name=codeblock-0-11 href=#codeblock-0-11></a>    <span class=n>max_length</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>field</span><span class=p>()</span>
<a id=codeblock-0-12 name=codeblock-0-12 href=#codeblock-0-12></a>
<a id=codeblock-0-13 name=codeblock-0-13 href=#codeblock-0-13></a>    <span class=c1># Enforcing the implementation of `compute` method in plugins</span>
<a id=codeblock-0-14 name=codeblock-0-14 href=#codeblock-0-14></a>    <span class=nd>@abstract</span>
<a id=codeblock-0-15 name=codeblock-0-15 href=#codeblock-0-15></a>    <span class=k>def</span><span class=w> </span><span class=nf>compute</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>int</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=nb>int</span><span class=p>]:</span>
<a id=codeblock-0-16 name=codeblock-0-16 href=#codeblock-0-16></a>        <span class=k>pass</span>
</code></pre></div> <h3 id=create-the-pluginmanager-instance>Create the PluginManager Instance</h3> <p>Now we need to create an instance of the <code class=highlight>PluginManager</code>:</p> <ul> <li><strong>Optional <code class=highlight>name</code></strong>: You can provide an optional <code class=highlight>name</code> for your <code class=highlight>PluginManager</code>. This is not required.</li> <li><strong>Link Base Plugin</strong>: Link the base plugin to the <code class=highlight>PluginManager</code> using the <code class=highlight>base_plugin</code> parameter.</li> <li><strong>Custom Plugins via Home Path</strong>: To allow end-users to define their own custom plugins, specify a home path. This will automatically create the directory and load any plugins found under <code class=highlight>&lt;plugin_home_path&gt;/plugins</code>.</li> </ul> <div class=highlight><pre><span></span><code><a id=codeblock-1-1 name=codeblock-1-1 href=#codeblock-1-1></a><span class=n>pm_list_operations</span> <span class=o>=</span> <span class=n>PluginManager</span><span class=p>(</span>
<a id=codeblock-1-2 name=codeblock-1-2 href=#codeblock-1-2></a>    <span class=c1># Optinal: give a name to our plugin manager</span>
<a id=codeblock-1-3 name=codeblock-1-3 href=#codeblock-1-3></a>    <span class=s2>&quot;list_operations&quot;</span><span class=p>,</span>
<a id=codeblock-1-4 name=codeblock-1-4 href=#codeblock-1-4></a>    <span class=c1># Link the BasePlugin to our plugin manager</span>
<a id=codeblock-1-5 name=codeblock-1-5 href=#codeblock-1-5></a>    <span class=n>base_plugin</span><span class=o>=</span><span class=n>ListOperation</span><span class=p>,</span>
<a id=codeblock-1-6 name=codeblock-1-6 href=#codeblock-1-6></a>    <span class=c1># Optional: Home path for plugins - where we can put our Custom plugins and configuration file</span>
<a id=codeblock-1-7 name=codeblock-1-7 href=#codeblock-1-7></a>    <span class=n>home_path</span><span class=o>=</span><span class=s2>&quot;~/.koalak/pm_tutorial&quot;</span><span class=p>,</span>
<a id=codeblock-1-8 name=codeblock-1-8 href=#codeblock-1-8></a><span class=p>)</span>
</code></pre></div> <h3 id=initialize-the-pluginmanager>Initialize the PluginManager</h3> <p>After creating the <code class=highlight>PluginManager</code> instance, you need to call the <code class=highlight>PluginManager.init()</code> method. This will perform several important tasks, including:</p> <ul> <li><strong>First Run Setup</strong>: If this is the first run of the application, it will create the home path and necessary subfolders.</li> <li><strong>Plugin Loading</strong>: It will load any plugins found in <code class=highlight>&lt;plugin_home_path&gt;/plugins</code>.</li> <li><strong>Configuration Loading</strong>: If any plugins have parameters that can be customized via the <code class=highlight>config.toml</code> file, it will load the appropriate configuration.</li> </ul> <div class=highlight><pre><span></span><code><a id=codeblock-2-1 name=codeblock-2-1 href=#codeblock-2-1></a><span class=n>pm_list_operations</span><span class=o>.</span><span class=n>init</span><span class=p>()</span>
</code></pre></div> <h3 id=create-our-plugins>Create our plugins</h3> <p>Now let's create our plugins. Our first plugin will simply multiply each element in the list by three. To register the plugin, we only need to subclass the <code class=highlight>BasePlugin</code>, which will automatically register it. However, our plugin must meet all the constraints imposed by the base plugin:</p> <ul> <li><strong>name</strong>: Every plugin must have a <strong>unique</strong> <code class=highlight>name</code>. This is required by all plugin managers, even if it isn't explicitly imposed by the base plugin.</li> <li><strong>max_length</strong>: We require all plugins to define the <code class=highlight>max_length</code> attribute as an integer. If this attribute is missing or of an incorrect type, an error will be raised when the plugin class is defined.</li> <li><strong>metadata</strong>: The base class requires all plugins to specify the <code class=highlight>category</code> metadata, choosing either <code class=highlight>transform</code> or <code class=highlight>filter</code>. Since our plugin modifies values without changing the number of elements, we will set <code class=highlight>category</code> to <code class=highlight>transform</code>.</li> </ul> <p>Additionally, we can provide other metadata, such as a <code class=highlight>description</code>, to describe the functionality of our plugin (though this is optional).</p> <div class=highlight><pre><span></span><code><a id=codeblock-3-1 name=codeblock-3-1 href=#codeblock-3-1></a><span class=c1># Creating plugins by inheriting the base class</span>
<a id=codeblock-3-2 name=codeblock-3-2 href=#codeblock-3-2></a><span class=k>class</span><span class=w> </span><span class=nc>TripleListOperator</span><span class=p>(</span><span class=n>ListOperation</span><span class=p>):</span>
<a id=codeblock-3-3 name=codeblock-3-3 href=#codeblock-3-3></a>    <span class=n>name</span> <span class=o>=</span> <span class=s2>&quot;triple&quot;</span>
<a id=codeblock-3-4 name=codeblock-3-4 href=#codeblock-3-4></a>    <span class=n>metadata</span> <span class=o>=</span> <span class=n>Metadata</span><span class=p>(</span><span class=n>category</span><span class=o>=</span><span class=s2>&quot;transform&quot;</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Triple each element&quot;</span><span class=p>)</span>
<a id=codeblock-3-5 name=codeblock-3-5 href=#codeblock-3-5></a>    <span class=n>max_length</span> <span class=o>=</span> <span class=mi>100</span>
<a id=codeblock-3-6 name=codeblock-3-6 href=#codeblock-3-6></a>
<a id=codeblock-3-7 name=codeblock-3-7 href=#codeblock-3-7></a>    <span class=k>def</span><span class=w> </span><span class=nf>compute</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>):</span>
<a id=codeblock-3-8 name=codeblock-3-8 href=#codeblock-3-8></a>        <span class=k>return</span> <span class=p>[</span><span class=n>e</span> <span class=o>*</span> <span class=mi>3</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>data</span><span class=p>]</span>
</code></pre></div> <p>If we want some plugins to run before others, we can modify the <code class=highlight>order</code> key in the metadata, which defaults to <code class=highlight><span class=mf>50</span></code>. By setting a lower value (e.g., <code class=highlight><span class=mf>1</span></code>), we can ensure that the plugin runs first.</p> <div class=highlight><pre><span></span><code><a id=codeblock-4-1 name=codeblock-4-1 href=#codeblock-4-1></a><span class=k>class</span><span class=w> </span><span class=nc>AddFiveListOperator</span><span class=p>(</span><span class=n>ListOperation</span><span class=p>):</span>
<a id=codeblock-4-2 name=codeblock-4-2 href=#codeblock-4-2></a>    <span class=n>name</span> <span class=o>=</span> <span class=s2>&quot;add_five&quot;</span>
<a id=codeblock-4-3 name=codeblock-4-3 href=#codeblock-4-3></a>    <span class=n>metadata</span> <span class=o>=</span> <span class=n>Metadata</span><span class=p>(</span>
<a id=codeblock-4-4 name=codeblock-4-4 href=#codeblock-4-4></a>        <span class=n>category</span><span class=o>=</span><span class=s2>&quot;transform&quot;</span><span class=p>,</span>
<a id=codeblock-4-5 name=codeblock-4-5 href=#codeblock-4-5></a>        <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Add the number 5 to each element&quot;</span><span class=p>,</span>
<a id=codeblock-4-6 name=codeblock-4-6 href=#codeblock-4-6></a>        <span class=c1># Ensure plugin add_five runs first (default order is 50)</span>
<a id=codeblock-4-7 name=codeblock-4-7 href=#codeblock-4-7></a>        <span class=n>order</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<a id=codeblock-4-8 name=codeblock-4-8 href=#codeblock-4-8></a>    <span class=p>)</span>
<a id=codeblock-4-9 name=codeblock-4-9 href=#codeblock-4-9></a>    <span class=n>max_length</span> <span class=o>=</span> <span class=mi>100</span>
<a id=codeblock-4-10 name=codeblock-4-10 href=#codeblock-4-10></a>
<a id=codeblock-4-11 name=codeblock-4-11 href=#codeblock-4-11></a>    <span class=k>def</span><span class=w> </span><span class=nf>compute</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>):</span>
<a id=codeblock-4-12 name=codeblock-4-12 href=#codeblock-4-12></a>        <span class=k>return</span> <span class=p>[</span><span class=n>e</span> <span class=o>+</span> <span class=mi>5</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>data</span><span class=p>]</span>
</code></pre></div> <p>We can create another plugin that filters the list to keep only even numbers. This plugin will belong to the <code class=highlight>filter</code> category, as it modifies the data by reducing the number of elements.</p> <div class=highlight><pre><span></span><code><a id=codeblock-5-1 name=codeblock-5-1 href=#codeblock-5-1></a><span class=k>class</span><span class=w> </span><span class=nc>KeepEvenListOperator</span><span class=p>(</span><span class=n>ListOperation</span><span class=p>):</span>
<a id=codeblock-5-2 name=codeblock-5-2 href=#codeblock-5-2></a>    <span class=n>name</span> <span class=o>=</span> <span class=s2>&quot;keep_even&quot;</span>
<a id=codeblock-5-3 name=codeblock-5-3 href=#codeblock-5-3></a>    <span class=n>metadata</span> <span class=o>=</span> <span class=n>Metadata</span><span class=p>(</span><span class=n>category</span><span class=o>=</span><span class=s2>&quot;filter&quot;</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Keep only even element&quot;</span><span class=p>)</span>
<a id=codeblock-5-4 name=codeblock-5-4 href=#codeblock-5-4></a>    <span class=n>max_length</span> <span class=o>=</span> <span class=mi>100</span>
<a id=codeblock-5-5 name=codeblock-5-5 href=#codeblock-5-5></a>
<a id=codeblock-5-6 name=codeblock-5-6 href=#codeblock-5-6></a>    <span class=k>def</span><span class=w> </span><span class=nf>compute</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>):</span>
<a id=codeblock-5-7 name=codeblock-5-7 href=#codeblock-5-7></a>        <span class=k>return</span> <span class=p>[</span><span class=n>e</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>data</span> <span class=k>if</span> <span class=n>e</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>]</span>
</code></pre></div> <p>Our last plugin will add a custom number "x" to each element. By default, the value of <code class=highlight>x</code> is 10. However, we want to provide the end users the ability to customize this behavior by specifying any value they want through the configuration file located at <code class=highlight>&lt;home_path&gt;/config.toml</code>. This is accomplished using the <code class=highlight>plugin_manager.config_field</code>.</p> <div class=highlight><pre><span></span><code><a id=codeblock-6-1 name=codeblock-6-1 href=#codeblock-6-1></a><span class=k>class</span><span class=w> </span><span class=nc>AddFiveListOperator</span><span class=p>(</span><span class=n>ListOperation</span><span class=p>):</span>
<a id=codeblock-6-2 name=codeblock-6-2 href=#codeblock-6-2></a>    <span class=n>name</span> <span class=o>=</span> <span class=s2>&quot;add_x&quot;</span>
<a id=codeblock-6-3 name=codeblock-6-3 href=#codeblock-6-3></a>    <span class=n>metadata</span> <span class=o>=</span> <span class=n>Metadata</span><span class=p>(</span>
<a id=codeblock-6-4 name=codeblock-6-4 href=#codeblock-6-4></a>        <span class=n>category</span><span class=o>=</span><span class=s2>&quot;transform&quot;</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Add the number X to each element&quot;</span>
<a id=codeblock-6-5 name=codeblock-6-5 href=#codeblock-6-5></a>    <span class=p>)</span>
<a id=codeblock-6-6 name=codeblock-6-6 href=#codeblock-6-6></a>    <span class=n>max_length</span> <span class=o>=</span> <span class=mi>100</span>
<a id=codeblock-6-7 name=codeblock-6-7 href=#codeblock-6-7></a>    <span class=c1># This attribute &quot;x&quot; is a config field, meaning that it can be modified from the configuration file &quot;~/.koalak/pm_tutorial/conf.toml&quot;</span>
<a id=codeblock-6-8 name=codeblock-6-8 href=#codeblock-6-8></a>    <span class=n>x</span> <span class=o>=</span> <span class=n>config_field</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
<a id=codeblock-6-9 name=codeblock-6-9 href=#codeblock-6-9></a>
<a id=codeblock-6-10 name=codeblock-6-10 href=#codeblock-6-10></a>    <span class=k>def</span><span class=w> </span><span class=nf>compute</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>):</span>
<a id=codeblock-6-11 name=codeblock-6-11 href=#codeblock-6-11></a>        <span class=k>return</span> <span class=p>[</span><span class=n>e</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>data</span><span class=p>]</span>
</code></pre></div> <h3 id=implement-core-business-logic>Implement Core Business Logic</h3> <p>Now that we have defined all our plugins, we can implement the core logic of the app. To interact with a plugin, we can either:</p> <ul> <li>Retrieve a specific plugin by its unique name using <code class=highlight><span class=n>plugin_manager</span><span class=o>[</span><span class=n>plugin_name</span><span class=o>]</span></code>.</li> <li>Iterate through all the plugins in the <code class=highlight>plugin_manager</code>, which will be returned sorted by <code class=highlight>metadata.order</code>.</li> </ul> <p>Here's how to do it:</p> <div class=highlight><pre><span></span><code><a id=codeblock-7-1 name=codeblock-7-1 href=#codeblock-7-1></a><span class=n>data</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>]</span>
<a id=codeblock-7-2 name=codeblock-7-2 href=#codeblock-7-2></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Initial data </span><span class=si>{</span><span class=n>data</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=codeblock-7-3 name=codeblock-7-3 href=#codeblock-7-3></a>
<a id=codeblock-7-4 name=codeblock-7-4 href=#codeblock-7-4></a><span class=c1># Iterating through all plugins</span>
<a id=codeblock-7-5 name=codeblock-7-5 href=#codeblock-7-5></a><span class=c1># The plugin with the lowest metadata.order will run first.</span>
<a id=codeblock-7-6 name=codeblock-7-6 href=#codeblock-7-6></a><span class=k>for</span> <span class=n>plugin_cls</span> <span class=ow>in</span> <span class=n>pm_list_operations</span><span class=p>:</span>
<a id=codeblock-7-7 name=codeblock-7-7 href=#codeblock-7-7></a>    <span class=n>plugin_instance</span> <span class=o>=</span> <span class=n>plugin_cls</span><span class=p>()</span>
<a id=codeblock-7-8 name=codeblock-7-8 href=#codeblock-7-8></a>    <span class=nb>print</span><span class=p>(</span>
<a id=codeblock-7-9 name=codeblock-7-9 href=#codeblock-7-9></a>        <span class=sa>f</span><span class=s2>&quot;Running plugin &#39;</span><span class=si>{</span><span class=n>plugin_cls</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39; of category &#39;</span><span class=si>{</span><span class=n>plugin_cls</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>category</span><span class=si>}</span><span class=s2>&#39;&quot;</span>
<a id=codeblock-7-10 name=codeblock-7-10 href=#codeblock-7-10></a>    <span class=p>)</span>
<a id=codeblock-7-11 name=codeblock-7-11 href=#codeblock-7-11></a>    <span class=n>data</span> <span class=o>=</span> <span class=n>plugin_instance</span><span class=o>.</span><span class=n>compute</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
<a id=codeblock-7-12 name=codeblock-7-12 href=#codeblock-7-12></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Current data </span><span class=si>{</span><span class=n>data</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=codeblock-7-13 name=codeblock-7-13 href=#codeblock-7-13></a><span class=nb>print</span><span class=p>()</span>
<a id=codeblock-7-14 name=codeblock-7-14 href=#codeblock-7-14></a>
<a id=codeblock-7-15 name=codeblock-7-15 href=#codeblock-7-15></a><span class=c1># Get plugin by name</span>
<a id=codeblock-7-16 name=codeblock-7-16 href=#codeblock-7-16></a><span class=n>plugin_cls</span> <span class=o>=</span> <span class=n>pm_list_operations</span><span class=p>[</span><span class=s2>&quot;add_five&quot;</span><span class=p>]</span>
<a id=codeblock-7-17 name=codeblock-7-17 href=#codeblock-7-17></a><span class=n>plugin_instance</span> <span class=o>=</span> <span class=n>plugin_cls</span><span class=p>()</span>
<a id=codeblock-7-18 name=codeblock-7-18 href=#codeblock-7-18></a><span class=n>data</span> <span class=o>=</span> <span class=n>plugin_instance</span><span class=o>.</span><span class=n>compute</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
<a id=codeblock-7-19 name=codeblock-7-19 href=#codeblock-7-19></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;After running &#39;add_five&#39; plugin again: </span><span class=si>{</span><span class=n>data</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</code></pre></div> <h3 id=all-the-code>All the code</h3> <div class=highlight><pre><span></span><code><a id=codeblock-8-1 name=codeblock-8-1 href=#codeblock-8-1></a><span class=c1># Importing PluginManager</span>
<a id=codeblock-8-2 name=codeblock-8-2 href=#codeblock-8-2></a><span class=kn>from</span><span class=w> </span><span class=nn>koalak.plugin_manager</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
<a id=codeblock-8-3 name=codeblock-8-3 href=#codeblock-8-3></a>    <span class=n>PluginManager</span><span class=p>,</span>
<a id=codeblock-8-4 name=codeblock-8-4 href=#codeblock-8-4></a>    <span class=n>Plugin</span><span class=p>,</span>
<a id=codeblock-8-5 name=codeblock-8-5 href=#codeblock-8-5></a>    <span class=n>Metadata</span><span class=p>,</span>
<a id=codeblock-8-6 name=codeblock-8-6 href=#codeblock-8-6></a>    <span class=n>field</span><span class=p>,</span>
<a id=codeblock-8-7 name=codeblock-8-7 href=#codeblock-8-7></a>    <span class=n>abstract</span><span class=p>,</span>
<a id=codeblock-8-8 name=codeblock-8-8 href=#codeblock-8-8></a>    <span class=n>config_field</span><span class=p>,</span>
<a id=codeblock-8-9 name=codeblock-8-9 href=#codeblock-8-9></a><span class=p>)</span>
<a id=codeblock-8-10 name=codeblock-8-10 href=#codeblock-8-10></a>
<a id=codeblock-8-11 name=codeblock-8-11 href=#codeblock-8-11></a>
<a id=codeblock-8-12 name=codeblock-8-12 href=#codeblock-8-12></a><span class=c1># ================================= #</span>
<a id=codeblock-8-13 name=codeblock-8-13 href=#codeblock-8-13></a><span class=c1># 01 - Define the Base Plugin class #</span>
<a id=codeblock-8-14 name=codeblock-8-14 href=#codeblock-8-14></a><span class=c1># ================================= #</span>
<a id=codeblock-8-15 name=codeblock-8-15 href=#codeblock-8-15></a><span class=k>class</span><span class=w> </span><span class=nc>ListOperation</span><span class=p>(</span><span class=n>Plugin</span><span class=p>):</span>
<a id=codeblock-8-16 name=codeblock-8-16 href=#codeblock-8-16></a>    <span class=k>class</span><span class=w> </span><span class=nc>Metadata</span><span class=p>:</span>
<a id=codeblock-8-17 name=codeblock-8-17 href=#codeblock-8-17></a>        <span class=c1># Force all plugins to have the &#39;category&#39; metadata which is equal to &#39;filter&#39; or &#39;transform&#39;</span>
<a id=codeblock-8-18 name=codeblock-8-18 href=#codeblock-8-18></a>        <span class=n>category</span> <span class=o>=</span> <span class=n>field</span><span class=p>(</span><span class=n>choices</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;filter&quot;</span><span class=p>,</span> <span class=s2>&quot;transform&quot;</span><span class=p>])</span>
<a id=codeblock-8-19 name=codeblock-8-19 href=#codeblock-8-19></a>
<a id=codeblock-8-20 name=codeblock-8-20 href=#codeblock-8-20></a>    <span class=c1># Enforcing the implementation of `compute` method in plugins</span>
<a id=codeblock-8-21 name=codeblock-8-21 href=#codeblock-8-21></a>    <span class=nd>@abstract</span>
<a id=codeblock-8-22 name=codeblock-8-22 href=#codeblock-8-22></a>    <span class=k>def</span><span class=w> </span><span class=nf>compute</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>int</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=nb>int</span><span class=p>]:</span>
<a id=codeblock-8-23 name=codeblock-8-23 href=#codeblock-8-23></a>        <span class=k>pass</span>
<a id=codeblock-8-24 name=codeblock-8-24 href=#codeblock-8-24></a>
<a id=codeblock-8-25 name=codeblock-8-25 href=#codeblock-8-25></a>
<a id=codeblock-8-26 name=codeblock-8-26 href=#codeblock-8-26></a><span class=c1># ================================== #</span>
<a id=codeblock-8-27 name=codeblock-8-27 href=#codeblock-8-27></a><span class=c1># 02 - Create PluginManager Instance #</span>
<a id=codeblock-8-28 name=codeblock-8-28 href=#codeblock-8-28></a><span class=c1># ================================== #</span>
<a id=codeblock-8-29 name=codeblock-8-29 href=#codeblock-8-29></a>
<a id=codeblock-8-30 name=codeblock-8-30 href=#codeblock-8-30></a><span class=n>pm_list_operations</span> <span class=o>=</span> <span class=n>PluginManager</span><span class=p>(</span>
<a id=codeblock-8-31 name=codeblock-8-31 href=#codeblock-8-31></a>    <span class=c1># Optinal: give a name to our plugin manager</span>
<a id=codeblock-8-32 name=codeblock-8-32 href=#codeblock-8-32></a>    <span class=s2>&quot;list_operations&quot;</span><span class=p>,</span>
<a id=codeblock-8-33 name=codeblock-8-33 href=#codeblock-8-33></a>    <span class=c1># Link the BasePlugin to our plugin manager</span>
<a id=codeblock-8-34 name=codeblock-8-34 href=#codeblock-8-34></a>    <span class=n>base_plugin</span><span class=o>=</span><span class=n>ListOperation</span><span class=p>,</span>
<a id=codeblock-8-35 name=codeblock-8-35 href=#codeblock-8-35></a>    <span class=c1># Optional: Home path for plugins - where we can put our Custom plugins and configuration file</span>
<a id=codeblock-8-36 name=codeblock-8-36 href=#codeblock-8-36></a>    <span class=n>home_path</span><span class=o>=</span><span class=s2>&quot;~/.koalak/pm_tutorial&quot;</span><span class=p>,</span>
<a id=codeblock-8-37 name=codeblock-8-37 href=#codeblock-8-37></a><span class=p>)</span>
<a id=codeblock-8-38 name=codeblock-8-38 href=#codeblock-8-38></a>
<a id=codeblock-8-39 name=codeblock-8-39 href=#codeblock-8-39></a><span class=c1># =============================#</span>
<a id=codeblock-8-40 name=codeblock-8-40 href=#codeblock-8-40></a><span class=c1># 03 - Init the plugin manager #</span>
<a id=codeblock-8-41 name=codeblock-8-41 href=#codeblock-8-41></a><span class=c1># ============================ #</span>
<a id=codeblock-8-42 name=codeblock-8-42 href=#codeblock-8-42></a><span class=n>pm_list_operations</span><span class=o>.</span><span class=n>init</span><span class=p>()</span>
<a id=codeblock-8-43 name=codeblock-8-43 href=#codeblock-8-43></a>
<a id=codeblock-8-44 name=codeblock-8-44 href=#codeblock-8-44></a><span class=c1># ======================= #</span>
<a id=codeblock-8-45 name=codeblock-8-45 href=#codeblock-8-45></a><span class=c1># 04 - Create the plugins #</span>
<a id=codeblock-8-46 name=codeblock-8-46 href=#codeblock-8-46></a><span class=c1># ======================= #</span>
<a id=codeblock-8-47 name=codeblock-8-47 href=#codeblock-8-47></a>
<a id=codeblock-8-48 name=codeblock-8-48 href=#codeblock-8-48></a><span class=c1># Creating plugins by inheriting the base class</span>
<a id=codeblock-8-49 name=codeblock-8-49 href=#codeblock-8-49></a><span class=k>class</span><span class=w> </span><span class=nc>TripleListOperator</span><span class=p>(</span><span class=n>ListOperation</span><span class=p>):</span>
<a id=codeblock-8-50 name=codeblock-8-50 href=#codeblock-8-50></a>    <span class=n>name</span> <span class=o>=</span> <span class=s2>&quot;triple&quot;</span>
<a id=codeblock-8-51 name=codeblock-8-51 href=#codeblock-8-51></a>    <span class=n>metadata</span> <span class=o>=</span> <span class=n>Metadata</span><span class=p>(</span><span class=n>category</span><span class=o>=</span><span class=s2>&quot;transform&quot;</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Triple each element&quot;</span><span class=p>)</span>
<a id=codeblock-8-52 name=codeblock-8-52 href=#codeblock-8-52></a>    <span class=n>max_length</span> <span class=o>=</span> <span class=mi>100</span>
<a id=codeblock-8-53 name=codeblock-8-53 href=#codeblock-8-53></a>
<a id=codeblock-8-54 name=codeblock-8-54 href=#codeblock-8-54></a>    <span class=k>def</span><span class=w> </span><span class=nf>compute</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>):</span>
<a id=codeblock-8-55 name=codeblock-8-55 href=#codeblock-8-55></a>        <span class=k>return</span> <span class=p>[</span><span class=n>e</span> <span class=o>*</span> <span class=mi>3</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>data</span><span class=p>]</span>
<a id=codeblock-8-56 name=codeblock-8-56 href=#codeblock-8-56></a>
<a id=codeblock-8-57 name=codeblock-8-57 href=#codeblock-8-57></a>
<a id=codeblock-8-58 name=codeblock-8-58 href=#codeblock-8-58></a><span class=k>class</span><span class=w> </span><span class=nc>AddFiveListOperator</span><span class=p>(</span><span class=n>ListOperation</span><span class=p>):</span>
<a id=codeblock-8-59 name=codeblock-8-59 href=#codeblock-8-59></a>    <span class=n>name</span> <span class=o>=</span> <span class=s2>&quot;add_five&quot;</span>
<a id=codeblock-8-60 name=codeblock-8-60 href=#codeblock-8-60></a>    <span class=n>metadata</span> <span class=o>=</span> <span class=n>Metadata</span><span class=p>(</span>
<a id=codeblock-8-61 name=codeblock-8-61 href=#codeblock-8-61></a>        <span class=n>category</span><span class=o>=</span><span class=s2>&quot;transform&quot;</span><span class=p>,</span>
<a id=codeblock-8-62 name=codeblock-8-62 href=#codeblock-8-62></a>        <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Add the number 5 to each element&quot;</span><span class=p>,</span>
<a id=codeblock-8-63 name=codeblock-8-63 href=#codeblock-8-63></a>        <span class=c1># Ensure plugin add_five run first. By default order is equal to 50.</span>
<a id=codeblock-8-64 name=codeblock-8-64 href=#codeblock-8-64></a>        <span class=n>order</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<a id=codeblock-8-65 name=codeblock-8-65 href=#codeblock-8-65></a>    <span class=p>)</span>
<a id=codeblock-8-66 name=codeblock-8-66 href=#codeblock-8-66></a>    <span class=n>max_length</span> <span class=o>=</span> <span class=mi>100</span>
<a id=codeblock-8-67 name=codeblock-8-67 href=#codeblock-8-67></a>
<a id=codeblock-8-68 name=codeblock-8-68 href=#codeblock-8-68></a>    <span class=k>def</span><span class=w> </span><span class=nf>compute</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>):</span>
<a id=codeblock-8-69 name=codeblock-8-69 href=#codeblock-8-69></a>        <span class=k>return</span> <span class=p>[</span><span class=n>e</span> <span class=o>+</span> <span class=mi>5</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>data</span><span class=p>]</span>
<a id=codeblock-8-70 name=codeblock-8-70 href=#codeblock-8-70></a>
<a id=codeblock-8-71 name=codeblock-8-71 href=#codeblock-8-71></a>
<a id=codeblock-8-72 name=codeblock-8-72 href=#codeblock-8-72></a><span class=k>class</span><span class=w> </span><span class=nc>KeepEvenListOperator</span><span class=p>(</span><span class=n>ListOperation</span><span class=p>):</span>
<a id=codeblock-8-73 name=codeblock-8-73 href=#codeblock-8-73></a>    <span class=n>name</span> <span class=o>=</span> <span class=s2>&quot;keep_even&quot;</span>
<a id=codeblock-8-74 name=codeblock-8-74 href=#codeblock-8-74></a>    <span class=n>metadata</span> <span class=o>=</span> <span class=n>Metadata</span><span class=p>(</span><span class=n>category</span><span class=o>=</span><span class=s2>&quot;filter&quot;</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Keep only even element&quot;</span><span class=p>)</span>
<a id=codeblock-8-75 name=codeblock-8-75 href=#codeblock-8-75></a>    <span class=n>max_length</span> <span class=o>=</span> <span class=mi>100</span>
<a id=codeblock-8-76 name=codeblock-8-76 href=#codeblock-8-76></a>
<a id=codeblock-8-77 name=codeblock-8-77 href=#codeblock-8-77></a>    <span class=k>def</span><span class=w> </span><span class=nf>compute</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>):</span>
<a id=codeblock-8-78 name=codeblock-8-78 href=#codeblock-8-78></a>        <span class=k>return</span> <span class=p>[</span><span class=n>e</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>data</span> <span class=k>if</span> <span class=n>e</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>]</span>
<a id=codeblock-8-79 name=codeblock-8-79 href=#codeblock-8-79></a>
<a id=codeblock-8-80 name=codeblock-8-80 href=#codeblock-8-80></a>
<a id=codeblock-8-81 name=codeblock-8-81 href=#codeblock-8-81></a><span class=k>class</span><span class=w> </span><span class=nc>AddFiveListOperator</span><span class=p>(</span><span class=n>ListOperation</span><span class=p>):</span>
<a id=codeblock-8-82 name=codeblock-8-82 href=#codeblock-8-82></a>    <span class=n>name</span> <span class=o>=</span> <span class=s2>&quot;add_x&quot;</span>
<a id=codeblock-8-83 name=codeblock-8-83 href=#codeblock-8-83></a>    <span class=n>metadata</span> <span class=o>=</span> <span class=n>Metadata</span><span class=p>(</span>
<a id=codeblock-8-84 name=codeblock-8-84 href=#codeblock-8-84></a>        <span class=n>category</span><span class=o>=</span><span class=s2>&quot;transform&quot;</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Add the number X to each element&quot;</span>
<a id=codeblock-8-85 name=codeblock-8-85 href=#codeblock-8-85></a>    <span class=p>)</span>
<a id=codeblock-8-86 name=codeblock-8-86 href=#codeblock-8-86></a>    <span class=n>max_length</span> <span class=o>=</span> <span class=mi>100</span>
<a id=codeblock-8-87 name=codeblock-8-87 href=#codeblock-8-87></a>    <span class=c1># This attribute &quot;x&quot; is a config field, meaning that it can be modified from the configuration file &quot;~/.koalak/pm_tutorial/conf.toml&quot;</span>
<a id=codeblock-8-88 name=codeblock-8-88 href=#codeblock-8-88></a>    <span class=n>x</span> <span class=o>=</span> <span class=n>config_field</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
<a id=codeblock-8-89 name=codeblock-8-89 href=#codeblock-8-89></a>
<a id=codeblock-8-90 name=codeblock-8-90 href=#codeblock-8-90></a>    <span class=k>def</span><span class=w> </span><span class=nf>compute</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>):</span>
<a id=codeblock-8-91 name=codeblock-8-91 href=#codeblock-8-91></a>        <span class=k>return</span> <span class=p>[</span><span class=n>e</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>data</span><span class=p>]</span>
<a id=codeblock-8-92 name=codeblock-8-92 href=#codeblock-8-92></a>
<a id=codeblock-8-93 name=codeblock-8-93 href=#codeblock-8-93></a>
<a id=codeblock-8-94 name=codeblock-8-94 href=#codeblock-8-94></a><span class=c1># ================================== #</span>
<a id=codeblock-8-95 name=codeblock-8-95 href=#codeblock-8-95></a><span class=c1># 05 - Implement core business logic #</span>
<a id=codeblock-8-96 name=codeblock-8-96 href=#codeblock-8-96></a><span class=c1># ================================== #</span>
<a id=codeblock-8-97 name=codeblock-8-97 href=#codeblock-8-97></a>
<a id=codeblock-8-98 name=codeblock-8-98 href=#codeblock-8-98></a><span class=n>data</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>]</span>
<a id=codeblock-8-99 name=codeblock-8-99 href=#codeblock-8-99></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Initial data </span><span class=si>{</span><span class=n>data</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=codeblock-8-100 name=codeblock-8-100 href=#codeblock-8-100></a>
<a id=codeblock-8-101 name=codeblock-8-101 href=#codeblock-8-101></a><span class=c1># Iterating through all plugins</span>
<a id=codeblock-8-102 name=codeblock-8-102 href=#codeblock-8-102></a><span class=c1># The plugin add_five will be returned first, since it has the lower metadata.order.</span>
<a id=codeblock-8-103 name=codeblock-8-103 href=#codeblock-8-103></a><span class=k>for</span> <span class=n>plugin_cls</span> <span class=ow>in</span> <span class=n>pm_list_operations</span><span class=p>:</span>
<a id=codeblock-8-104 name=codeblock-8-104 href=#codeblock-8-104></a>    <span class=n>plugin_instance</span> <span class=o>=</span> <span class=n>plugin_cls</span><span class=p>()</span>
<a id=codeblock-8-105 name=codeblock-8-105 href=#codeblock-8-105></a>    <span class=nb>print</span><span class=p>(</span>
<a id=codeblock-8-106 name=codeblock-8-106 href=#codeblock-8-106></a>        <span class=sa>f</span><span class=s2>&quot;Running plugin &#39;</span><span class=si>{</span><span class=n>plugin_cls</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39; of category &#39;</span><span class=si>{</span><span class=n>plugin_cls</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>category</span><span class=si>}</span><span class=s2>&#39;&quot;</span>
<a id=codeblock-8-107 name=codeblock-8-107 href=#codeblock-8-107></a>    <span class=p>)</span>
<a id=codeblock-8-108 name=codeblock-8-108 href=#codeblock-8-108></a>    <span class=n>data</span> <span class=o>=</span> <span class=n>plugin_instance</span><span class=o>.</span><span class=n>compute</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
<a id=codeblock-8-109 name=codeblock-8-109 href=#codeblock-8-109></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Current data </span><span class=si>{</span><span class=n>data</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=codeblock-8-110 name=codeblock-8-110 href=#codeblock-8-110></a><span class=nb>print</span><span class=p>()</span>
<a id=codeblock-8-111 name=codeblock-8-111 href=#codeblock-8-111></a>
<a id=codeblock-8-112 name=codeblock-8-112 href=#codeblock-8-112></a><span class=c1># Get plugin by name</span>
<a id=codeblock-8-113 name=codeblock-8-113 href=#codeblock-8-113></a><span class=n>plugin_cls</span> <span class=o>=</span> <span class=n>pm_list_operations</span><span class=p>[</span><span class=s2>&quot;add_five&quot;</span><span class=p>]</span>
<a id=codeblock-8-114 name=codeblock-8-114 href=#codeblock-8-114></a><span class=n>plugin_instance</span> <span class=o>=</span> <span class=n>plugin_cls</span><span class=p>()</span>
<a id=codeblock-8-115 name=codeblock-8-115 href=#codeblock-8-115></a><span class=n>data</span> <span class=o>=</span> <span class=n>plugin_instance</span><span class=o>.</span><span class=n>compute</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
<a id=codeblock-8-116 name=codeblock-8-116 href=#codeblock-8-116></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;After running &#39;add_five&#39; plugin again: </span><span class=si>{</span><span class=n>data</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</code></pre></div> <p>If you run the script, the configuration file "~/.koalak/pm_tutorial/conf.toml" is created, you can modify it's value and run the script again to obtain different results.</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="May 30, 2025 23:09:21 CEST">May 30, 2025 23:09:21</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="May 30, 2025 23:09:21 CEST">May 30, 2025 23:09:21</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; Nazime LAKEHAL </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.top", "navigation.sections", "navigation.tracking", "navigation.indexes", "header.autohide", "content.code.copy"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.13a4f30d.min.js></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>